<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>乱数日記</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin-top: 0;
    }
    button {
      padding: 10px 16px;
      font-size: 16px;
      cursor: pointer;
    }
    .diary {
      margin-top: 20px;
      padding: 12px;
      background: #ffffff;
      border-radius: 6px;
    }
    .log {
      margin-top: 30px;
    }
    .entry {
      background: #ffffff;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 6px;
      font-size: 14px;
    }
    .date {
      font-size: 12px;
      color: #666;
    }
  </style>
</head>
<body>

<h1>乱数日記</h1>

<p>
この日記は、あなたの意思を一切反映しません。<br>
すべては乱数によって決定されます。
</p>

<button id="generate">日記を生成する</button>

<div class="diary" id="currentDiary" style="display:none;"></div>

<div class="log">
  <h2>過去の日記</h2>
  <div id="entries"></div>
</div>

<script>
  const whenList = [
    "ある平日の朝",
    "深夜",
    "休日の午後",
    "雨が降っていた日",
    "なぜか目が覚めた時間帯",
    "携帯の着信で起きた朝"
  ];

  const whereList = [
    "自室で",
    "通学路で",
    "知らない場所で",
    "インターネットの向こう側で",
    "布団の中で",
    "自分の昨日書いたクソコードのせいで",
    "このクソアプリのせいで",
    "画面の向こうのお前のせいで"
  ];

  const whoList = [
    "私が",
    "友人が",
    "知らない誰かが",
    "過去の自分が",
    "将来の自分が",
    "先輩が",
    "上司が",
    "母が",
    "某緑頭が"
  ];

  const whatList = [
    "スマートフォンを",
    "意味のないボタンを",
    "昨日の出来事を",
    "よく分からない装置を",
    "この日記を",
    "JAMを",
    "私を"
  ];

  const howList = [
    "静かに眺めていた",
    "突然破壊した",
    "特に理由もなく放置した",
    "深く反省した",
    "なかったことにした",
    "クソコードにした",
    "STACKしていた",
    "大声で叩き起こした。「先輩のクソコードのせいで本番が燃えてるのだ！」と"
  ];

  function rand(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  function generateDiary() {
    const sentence =
      rand(whenList) + "、" +
      rand(whereList) + rand(whoList) +
      rand(whatList) +
      rand(howList) + "。";

    return sentence;
  }

  function loadEntries() {
    const entries = JSON.parse(localStorage.getItem("randomDiary") || "[]");
    const container = document.getElementById("entries");
    container.innerHTML = "";

    entries.forEach(e => {
      const div = document.createElement("div");
      div.className = "entry";

      div.innerHTML = `
        <div class="date">${e.date}</div>
        <div>${e.text}</div>
      `;
      container.appendChild(div);
    });
  }

  document.getElementById("generate").addEventListener("click", () => {
    const text = generateDiary();
    const now = new Date().toLocaleString();

    const entry = { date: now, text };

    const entries = JSON.parse(localStorage.getItem("randomDiary") || "[]");
    entries.unshift(entry);
    localStorage.setItem("randomDiary", JSON.stringify(entries));

    const current = document.getElementById("currentDiary");
    current.style.display = "block";
    current.textContent = text;

    loadEntries();
  });

  loadEntries();
</script>

</body>
</html>
